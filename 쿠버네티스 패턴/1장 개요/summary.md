## 클라우드 네이티브로 가는길

- 클라우드 네이티브 플랫폼에서 가장 인기 많은 아키택처는 마이크로서비스 아키택처이다.
   - 개발 복잡성을 활용해서 비즈니스 기능의 모듈화를 통해 소프트웨어 복잡성을 해결한다.
- 마이크로서비스를 도입하는 움직임의 일환으로, 모놀리스를 MSA 로 분할하는데 쓰이는 이론과 보완 기술은 상당히 많다.

#### 1 계층. 클린코드
- 정의된 모든 변수, 생선한 모든 메소드, 인스턴스화하기로 결정한 모든 클래스가 장기간의 애플리케이션 유지 관리에 중요한 역할은 한다.
- 어떤 기술, 플랫폼을 사용하든 간에 해당 부분이 가장 큰 영향을 미칠 것이다.
- 무엇보다 클린 코드 작성을 위해 적절한 테스트 코드를 만들며, 지속적으로 리팩토링 해야 한다.

#### 2. 계층. 도메인 주소 설계 (DDD)
- 아키택처를 가능한 한 현실세계에 가깝게 맞추려는 의도로 비즈니스 관점에서 소프트웨어를 설계하는 방법이다.
- DDD 는 OOP 언어 중 가장 효과적이지만 그 밖에도 좋은 방법들이 많다.
- 올바른 비즈니스 및 트랜잭션 경계, 사용하기 쉬운 인터페이스, 풍부한 API 등을 갖춘 모델은 향우 성공적인 컨테이너화 및 자동화를 위한 기본이 될 것이다.

#### 3. 계층. 마이크로서비스 아키택처 (MSA)
- 현재 표준이며 계속적으로 변화하는 분산 애플리케이션 설계에 대한 소중한 원칙과 실용적인 방법을 제공한다.
- 스케일(scale)과 회복성(resiliency), 변화 속도에 최적화된 구현을 할 수 있다.

#### 4. 계층. 컨테이너
- 분산 애프리케이션을 패키징하고 실행하는 표준 방법
- 훌륭한 클라우드 네이티브 요소인 모듈식의 재사용 가능한 컨테이너를 만드는 것이 또 하나의 기본 전제 조건이다.
- 모든 조직에서 개발하는 컨테이너 수가 늘어남에 따라 해당 컨테이너들을 어떻게 하면 효율적으로 관리할 수 있을지에 대한 필요성이 대두되고 있다.
- 클라우드 네이티브는 새로운 용어로서, 컨테이너화된 대규모 MSA 를 자동화하기 위한 원칙과 패턴, 도구를 설명하는데 사용된다.
ㅎ
---

## 분산 기본 요소

| 개념                | 로컬 기본 요소                         | 분산 기본 요소                   |
|-------------------|----------------------------------|----------------------------|
| 캡슐화 동작            | 클래스                              | 컨테이지 이미지                   |
| 인스턴스화 동작          | 객체                               | 컨테이너                       |
| 재사용 단위            | .jar 파일                          | 컨테이너 이미지                   |
| 컴포지션(Composition) | 클래스 A가 클래스 B를 포함                 | 사이드카 패턴                    |
| 상속                | 클래스 A가 클래스 B를 확장                 | 'FROM 부모 이미지'로 만든 컨테이너 이미지 |
| 배포 단위             | .jar/.war/.ear                   | 파드                         |
| 빌드타임/런타임 격리       | 모듈, 패키지, 클래스                     | 네임스페이스, 파드, 컨테이너           |
| 초기화 필요 조건         | 생성자                              | 초기화 컨테이너                   |
| 초기화 직후 트리거        | Init 메소드                         | postStart                  |
| 삭제 직전 트리거         | Destory 메소드                      | preStop                    |
| 정리(Cleanup) 절차    | finalize(), 셧다운 훅                | Deler 컨테이너                 |
| 비동기 & 병렬 실행       | ThreadPoolExecutor, ForkJoinPool | 잡                          |
| 주기적 작업            | Timer, ScheduledExecutorService  | 크론잡                        |
| 백그라운드 작업          | 데몬 스레드                           | 데몬세트                       |
| 설정 관리             | System.getenv(), Properties      | 컨피그맵, 시크릿                  |

- 인프로세서(in-process) 기본 요소와 분산 기본 요소는 공통점이 있지만 직접적으로 비교하거나 서로 대체할 수 없다.
   - 이 둘은 다른 추상화 레벨에서 작동하며 다른 전제조건과 보장이 있다. 
- 일부 기본 요소는 함께 사용되어야 한다.
   - 예를 들어 객체를 생성하기 위해서 클래스를 사용해야 하고 이 클래스를 컨테이너 이미지에 넣어야 한다.
   - 그러나 쿠버네티스에서의 크론잡 같은 기본 요소는 자바의 ExecutorService 기능을 완벽하게 대체할 수 있다.

---

### 컨테이너 
- 컨테이너는 쿠버네티스 기반 클라우드 네이티브 애플리케이션의 빌딩 블록이다.
- OOP 자바와 비교하자면, 컨테이너 이미지는 클래스와 비슷하며 컨테이너는 객체와 비슷하다.
  - 클래스를 확장하여 동작을 재사용하고 변경하는 방식과 유사하게 컨테이너 이미지를 확장해 동작을 재사용하고 변경하는 컨테이너 이미지를 만들 수 있다.
- 객체를 컴포지션할 수 있고 기능을 사용하는 방식과 유사하게, 파드 안에 여러 컨테이너를 넣고 서로 협력하는 컨테이너를 사용함으로써 컨테이너를 컴포지션할 수 있다.
- 쿠버네티스는 JVM 과 비슷하지만 멀티 호스트로 분산시켜 컨테이너를 실행하고 관리하는 책임을 진다.
- 컨테이너는 쿠버네티스에서 기본적인 역할을 하고, 모듈화된 재사용 가능한 단일 목적의 컨테이너 이미지를 만드는 것은 모든 프로젝트는 물론이고 더 나아가 컨테이너 에코 시스템을을 효율적으로 사용할 수 있게 한다는 점이다.

### 파드
- 대부분 클라우드 네이티브 플랫폼은 컨테이너 그룹의 수명주기를 관리하기 위해서 또 다른 기본 요소를 제공하는데 이를 파드(Pod)라고 부른다.
- 컨테이너 그룹의 스케줄링과 배포, 그리고 격리된 런타임에 대한 최소 단위이다.
- 파드 안의 모든 컨테이너는 항상 같은 호스트에 스케줄링되고 호스트 이전이나 스케일을 목적으로 함께 배포되며, 파일 시스템, 네트워킹, 프로세스 네임스페이스를 공유 가능하다.
  - 이렇게 같은 수명주기 덕북에 파드 안의 컨테이너는 파일 시스템이나 로컬 호스트 혹은 호스트 간 프로세스 통신 매커니즘을 통한 네트워크 통신으로 컨테이너 간의 상호작용이 가능하다.
  
> #### 특징
> - 파드는 스케줄링의 최소 단위이다. 
>  - 스케줄러가 파드에 속한 모든 컨테이너의 요구사항을 만족하는 호스트를 찾으려고 시도 한다는 것이다.
> - 파드는 파드에 속한 컨테이너들의 동일 장소 배치(colocation)을 보장한다.
>   - 동일 장소 배치로 인해 동일한 파든 안의 컨테이너들은 서로 상호작용할 수 있다.
> - 하나의 파드는 파드 안의 모든 컨테이너가 공유하는 하나의 IP 주소와 이름 그리고 포트 범위를 갖는다
>   - 파드끼리 포트가 겹치지 않게 설계해야한다.
> - 파드는 언제든지 생성되고 사라질 수 있는 일시적인 자원이다.

### 서비스
- 강력한 또 하나의 추상화로 서비스 이름을 IP 주소와 포트 번호로 영구적으로 연결시켜 준다.
  - 애플리케이션에 접근하기 위한, 이름으로 된 진입점이다.

### 레이블
- 레이블은 실행 중인 특정 파드의 인스턴스들을 가리키기 위해 레플리카세트(ReplicaSet)에서 사용된다.

### 애노테이션
- 
---
