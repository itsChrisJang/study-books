# 제5장. 운영체제 개요
- 프로그램은 매우 단순한 일을 한다. 명령어를 실행한다. 
  - 프로세서는 명령어를 초당 수백만 번 (요즘은 수십억 번) 반입(fetch)하고, 해석(decode)하고 (즉, 무슨 명령어인지 파악하고), 실행(execute)한다.(즉, 두 수를 더하고, 메모리에 접근하고, 조건을 검사하고, 함수로 분기하는 등의 정해진 일을 한다). 
  - 명령어 작􏰂을 완료한 후 프로세서는 다음 명령어로, 또 그 다음 명령어로 프로그램이 완전히 종료될 때까지 실행을 계속한다.
- 프로그램을 쉽게 실행하고 (심지어 동시에 여러 발의 프로그램을 실행시킬 수도 있음), 프로그램 간의 메모리 공유를 가능케 하고, 장치와 상호작용을 가능케하고, 다양 흥미로운 일을 할 수 있게 하는 소프트웨어가 있다. 
  - 시스템을 사용하기 편리하면서 정확하고 올􏰍르게 동작시킬 책임이 있기 때문에 소프트웨어를 운영체제(operating system, OS)라고 부른다.
- 운영체제는 가상화라고 불리는 기법을 사용한다.
  - 운영체제는 프로세서, 메모리 또는 디스크와 같은 물리적인 자원을 이용하여 일반적이고, 강력하고, 사용이 편리한 가상 형태의 자원을 생성한다.
  - 이 때문에 때로는 가상 머신이라고 부른다.
- 사용자 프로그램의 프로그램 실행, 메모리 할당, 파일 접근과 같은 가상 머신과 관련된 기능들을 운영체제에게 요청할 수 있도록, 운영체제는 사용자에게 API를 제공한다. 
  - 보통 운영체제는 응용 프로그램이 사용 가능한 수백 발의 시스템 콜을 제공한다.
- 마지막으로, 가상화는 많은 프로그램들이 CPU를 공유하여, 동시에 실행될 수 있게 한다. 프로그램들이 각자 명령어와 데이터를 접근할 수 있게 한다. 
  - 프로그램들이 디스크 등의 장치를 공유할 수 있게 한다. 
  - 이러한 이유로 운영체제는 자원 관리자(resource manager)라고도 불린다. CPU, 메모리, 및 디스크는 시스템의 자원이다. 
  - 효율적으로, 공정하게, 이들 자원을 관리하는 것이 운영체제의 역할이다.
## 5.1 CPU 가상화
#### 반복해서 출력하는 코드
```cpp
#include <stdio.h>
#include <stdlib.h>
#include <sys/time.h>
#include <assert.h>
#include “common.h”

int
main(int argc, char *argv[])
{
    if (argc!=2) {
        fprintf(stderr,“usage: cpu <string>\n”);
        exit(1); 
    }
    char *str = argv[1];
    while (1) {
        Spin(1);
        printf(“%s\n”, str); 
    }
    return 0; 
}
```
#### 동시에 많은 프로그램 실행시키기
```shell
prompt> ./cpu A & ; ./cpu B & ; ./cpu C & ; ./cpu D & [1] 7353
[2] 7354
[3] 7355
[4] 7356 A
B
D
C
A
B 
D 
C 
A 
C 
B 
D
```
- 프로세서가 하나밖에 없음에도 프로그램 4개 모두 동시에 실행되는 것처럼 보인다.
- 하드웨어의 도움을 􏰛아 운영체제가 시스템에 매우 많은 수의 가상 CPU가 존재하는 듯한 **환상(illusion)**을 만들어 낸 것이다. 
  - 하나의 CPU 또는 소규모 CPU 집합을 무한 발의 CPU가 존재하는 것처럼 변환하여 동시에 많은 수의 프로그램을 실행시키는 것을 **CPU 가상화(virtualizing the CPU)**라 한다.
## 5.2 메모리 가상화
