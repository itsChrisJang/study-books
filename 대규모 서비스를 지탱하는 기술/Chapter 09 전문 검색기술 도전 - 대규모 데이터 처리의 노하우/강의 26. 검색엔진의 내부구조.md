# Chapter 09 전문 검색기술 도전 - 대규모 데이터 처리의 노하우---## 강의 26. 검색엔진의 내부구조### 역 인덱스의 구조 - Dictonary + Postings![역 인덱스의 예](image/example_inverted_index.png)- 예를 들어, "하테나"라는 단어를 검색하면 postings 리스트 `[1, 3, 4]`을 통해 해당 단어를 포함하는 문서를 찾을 수 있습니다.- 이와 같은 **term → 문서**의 매핑 구조를 **역인덱스(Inverted Index)**라고 합니다.- 역인덱스는 검색 엔진에서 **빠르게 검색 결과를 찾아주는 핵심 데이터 구조**입니다.#### 용어 정리- **Term**: 문서에서 추출한 단어 (형태소 분석이나 전처리를 통해 생성)- **Dictionary**: 모든 term의 집합- **Postings**: 각 term이 나타나는 문서 ID의 목록> #### 요약> 역인덱스 = **Dictionary + Postings**> - 단어 중심으로 문서를 역참조할 수 있도록 구성된 검색 인프라의 핵심 구조> - 단어를 기준으로 어떤 문서에 포함되어 있는지 즉시 확인 가능### Dictionary 만드는 법 - 역 인덱스 작성법#### 1. 사전과 AC법을 이용하는 방법사전이 곧 검색 시스템의 단어공간이 된다. 즉, 사전에 들어 있는 단어만 검색할 수 있다.   이 사전으로는 무엇을 사용할지에 따라 달라지는데 예를 들면 하테나 키워드의 27만 단어가 검색 가능한 검색엔진이 된다.   또는 Wikipedia가 배포하고 있는 데이터를 사용해서 표제어만을 사용하여 검색할 수 있도록 할 수 도 있다.#### 2. 형태소 분석을 이용하는 방법(형태소를 단어로 간주해서 term으로 한다)형태소 분석기는 실제로 무슨 기능을 하는 것일까?   가장 요구되는 것은 '유형파악과 분리' 기능이다. 이 원리에 따라 세세하게 나눈 각 단어를 '형태소'라고 한다.   '유형파악과 분리'에 의해 텍스트를 형태소로 분할하는 것이 형태소 분석기의 주된 기능 중 하나다.> - すもももももももものうち>   - すもも 명사>   - も 조사>   - もも 명사>   - も 조사>   - もも 명사>   - の 조사>   - うち 명사위와 같이 형태소 분석기는 문잔을 형태소로 나눠서 그 품사를 추정한다.   품사를 어떻게 추정하느냐는 구현에 따라서도 달라지지만 대부분의 경우에는 내부에 형태소 분석용 사전을 가지고 있어 그것을 토대로 판별한다.단어가 명사인지 아닌지는 사전만으로는 알 수 없지만, **단어의 배열(문맥)**을 통해 어느 정도 예측이 가능합니다. 예를 들면 다음과 같은 규칙을 기계학습 모델이 학습하게 됩니다:- “**명사 다음에는 조사가 온다**”- “**조사와 동사 사이에 포함되어 있는 것은 명사일 수 있다**”이러한 규칙을 바탕으로 모델은 긴 텍스트 내에서 특정 단어가 명사인지 동사인지, 또는 어느 정도 길이의 명사인지 등을 판단할 수 있습니다.##### 예시: ‘すもももももももものうち’| 단어                | 품사       ||---------------------|------------|| すもももももももも | 명사 (만화) || もも               | 명사       || の                 | 조사       || うち               | 명사       |- 첫 번째 `すもももももももも`는 분석기에 따라 하나의 명사로 판단되며, 그 뒤의 `もも`, `の`, `うち`도 각기 명사와 조사로 분리됩니다.#### 검색누락#### n-gram을 term으로 다루기#### 쿼리도 동일한 규칙으로 분할하기#### n-gram 분할 문제와 필터링#### 재현률(Recall)과 적합률(Precision)#### 검색 시스템 평가와 재현률/적합률### Postings 작성법 - 역 인덱스 작성법 #2 #### 출현 위치를 저장하지 않고 문서ID만을 저장하는 타입### 스코어링에 대한 보충