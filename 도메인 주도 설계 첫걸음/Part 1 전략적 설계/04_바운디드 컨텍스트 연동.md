# Part 1. 전략적 설계
## 04. 바운디드 컨텍스트 연동
- 다른 바운디드 컨텍스트의 모델은 서로 독립적이고 발전하고 구현되 수 있다.
  - 그러나 바운디드 컨텍스트 자체는 독립적이지 않다.
  - 시스템의 요소가 독립적으로 구성될 수 없듯이, 시스템의 요소가 전체의 목적을 이루기 위해 상호작용해야 하듯이, 바운디드 컨텍스트의 구현도 마찬가지다.
  - 결국, 바운디드 컨텍스트 사이에는 항상 접점이 있는데 이것을 컨트렉트라고 부른다.
-
### 협력형 패턴 그룹
- 협력형 그룹의 패턴은 소통이 잘 되는 팀에서 구현된 바운디드 컨텐스트와 관련이 있다.
#### 파트너십 패턴
- 바운디드 컨텍스트 간의 연동은 에드혹(ad-hoc) 방식으로 조정한다.
- 한 팀은 다른 팀에게 API의 변경을 알리고 다른 팀은 충돌 없이 이를 받아 들인다.
- 연동의 조정은 양방향에서 한다.
- 어떤 팀도 컨트랙트를 정의하는 데 쓰는 언어를 강요하지 않는다.
- 양 팀은 차이점을 함께 해결하고 가장 적절한 솔루션을 선정한다.
- 발생할 수 있는 연동의 문제를 해결하는 데 양 팀 모두 협력한다.
- 동기화와 커뮤니케이션의 어려움 때문에 지리적으로 떨어져 있는 팀에게는 적합하지 않을 수 있다.
#### 공유 커널 패턴
- 바운디드 컨텍스트가 모델의 경계임에도 불구하고, 여전히 하위 도메인의 동일 모델 혹은 그 일부가 여러 다른 바운디드 컨텍스트에서 구현되는 경우가 있다.
- 공유 범위
  - 겹치는 형태의 모델은 해당되는 바운디드 컨텍스트의 수명주기도 서로 엮이게 한다.
  - 공유 모델의 변경은 다른 모든 바운디드 컨텍스트에 즉시 영향을 준다.
    - 그러므로 변경의 연쇄 영향을 최소화하려면 양쪽의 겹치는 모델을 제한해서 바운디드 컨텍스트에서 공통으로 구현돼야 하는 모델의 일부분만 노출하도록 해야 한다.
- 구현
  - 소스코드의 모든 변경이 이를 사용하는 모든 바운디드 컨텍스트에 즉시 반영되도록 구현된다.
  - 어떤 방식이든 공유 커널에 대한 변경이 생길 때마다 영향을 받는 모든 바운디드 컨텍스트와 연동 테스트를 수행해야 한다.
- 공유 커널을 사용해야 하는 경우
  - 공유 커널 패턴의 정용 여부를 결정하는 가장 중요한 기준은 중복 비용과 조율 비용의 비율이다.
    - 이 패턴을 적용한 바운디드 컨텍스트 간에 강한 의존관계를 만들기 때문에 중복 비용이 조율 비용보다 클 경우에만 적용해야 한다.
    - 즉, 두 바운디드 컨텍스트가 공유하는 코드베이스에 대한 변경을 조율하려는 노력보다 공유하는 모델에 대한 변경을 통합할 때 드는 노력이 더 클 경우에 적용한다.
  - 어떤 의미에서 보면 공유 커너 패턴은 바운디드 컨텍스트의 원칙에 위배된다.
    - 같은 팀이 공유 커널을 구현하지 않는다면 이는 단일 팀 원칙을 위반하는 것이다.
  - 이러한 이유로 공유 커널을 사용하는 데는 명분이 필요하다.
### 사용자-제공자 패턴 그룹
- 제공자는 사용자에게 서비스를 제공한다.
- 서비스 제공자는 업스트림이고 고객 또는 사용자는 다운스트림이다.
- 협력 그룹의 경우와는 다르게 양 팀(업스트림과 다운스트림)은 서로 독립적으로 성공할 수 있다.
  - 그러나 대부분의 경우 업스트림 또는 다운스트림의 팀이 연동 컨트랙틀르 주도하는 권력의 불균형이 존재한다.
#### 순응주의자 패턴
- 힘의 균형이 서비스를 제공하는 업스트림 팀에 있는 경우가 있다.
  - 사용자의 요구를 지원할 동기가 없는 경우가 그렇다.
- 다운스트림 팀이 업스트림 팀의 모델을 받들이는 바운디드 컨텍스트의 관계를 순응주의자 패턴이라 부른다.
#### 충돌 방지 계층 패턴
- 순응주의자 패턴에서 힘의 균형은 업스트림 서비스에 치우쳐 있다.
  - 그러나 다운스트림 바운디드 컨텍스트가 이에 순응하지 않는 경우 충돌 방지 계층을 통해 업스트림 바운디드 컨텍스트의 모델을 스스로의 필요에 맞게 가공할 수 있다.
- 모델링 관점에서 다운스트림 사용자가 제공자의 모델을 변환하면 자신의 바운디드 컨텍스트와 상관없는 외부의 개념으로부터 다운스트림 사용자를 안전하게 보호할 수 있다.
#### 오픈 호스트 서비스 패턴
- 힘이 사용자 측에 있을 경우를 처리한다.
- 제공자는 사용자를 보호하고 가능한 최고의 서비스를 제공하는 데 관심이 있다.
- 구현 모델의 변경으로부터 사용자를 보호하기 위해 업스트림 제공자는 퍼블릭 인터페이스와 구현 모델을 분리한다.

### 분리형 노선
- 전혀 협력하지 않는 것
- 팀에 협업 의지가 없거나 협업할 수 없는 경우와 같이 다양한 이유가 있다.
#### 커뮤니케이션 이슈
- 조직의 규모와 내부 정치 요인으로 인한 커뮤니케이션의 어려움 때문이다.
#### 일반 하위 도메인
#### 모델의 차이

### 컨텍스트 맵
- 컨텍스트 맵은 시스템의 바운디드 컨텍스트와의 연동을 시각적으로 표현한다.
- 거시적 설계 관점
  - 컨텍스트 맵은 시스템의 구성요소와 구현하는 모델의 개요를 제공한다.
- 커뮤니케이션 패턴
  - 컨텍스트 맵은 시스템의 구성요소 간의 커뮤니케이션 패턴을 묘사한다.
- 조직적 문제
  - 컨텍스트 맵은 조직적 문제에 대한 통찰력은 제공한다.
#### 유지보수
- 컨텍스트 맵은 프로젝트 초기부터 도입해서 새로운 바운디드 컨텍스트와 기존 요소에 대한 수정을 반영하는 것이 이상적이다.
- 컵텍스트 맵은 여러 팀이 작업한 정보를 담기 때문에 다 ㅎ마께 유지보수하는 것이 제일 좋다.



