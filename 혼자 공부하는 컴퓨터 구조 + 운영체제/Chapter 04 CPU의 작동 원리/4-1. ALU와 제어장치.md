# Chapter 04. CPU의 작동 원리
## 4-1. ALU와 제어장치
- CPU는 메모리에 저장된 명령어를 읽어 들이고, 해석하고, 실행하는 장치이다.
- CPU 내부에는 계산을 담당하는 ALU, 명령어를 읽어 들이고 해석하는 제어장치, 작은 임시 저장 장치인 레지스터라는 구성요소가 있다.
- ALU와 제어장치가 받아들이고 내보내는 정보를 기준으로 ALU와 제어장치가 무엇을 내보내고, 무엇을 받아들이는지 알아보자
### ALU
- ALU
  - 레지스터로 부터 피연산자를 받아들이고, 제어장치로부터 제어 신호를 받아들입니다.
- ALU는 계산하는 부품이다.
  - 1+2를 계산할 때 1과 2라는 피연산자와 더하기라는 수행할 연산이 필요하듯 계산을 하기 위해서는 피연산자와 수행할 연산이 필요하다.
- **ALU**는 레지스터를 통해 **피연산자**를 받아들이고, 제어장치로부터 수행할 연산을 알려주는 **제어 신호**를 받아들인다.
  - ALU는 레지스터와 제어장치로부터 받아들인 피연산자와 제어 신호로 산술 연산, 논리 연산 등 다양한 연산을 수행한다.
- ALU가 내보내는 정보
  - 연산을 수행한 결과는 특정 숫자나 문자가 될 수 있고, 메모리 주소가 될 수 도 있다.
    - 그리고 이 결괏값은 바로 메모리에 저장되지 않고 일시적으로 레지스터에 저장된다.
    - CPU가 메모리에 접근하는 속도는 레지스터에 접근하는 속도보다 훨씬 느리다.
      - ALU가 연산할 때마다 결과를 메모리에 저장한다면 당연하게도 CPU는 메모리에 자주 접근하게 되고, 이는 CPU가 프로그램 실행 속도를 늦출 수 있다. 그래서 ALU의 결괏값을 메모리가 아닌 레지스터에 우선 저장하는 것이다. 
  - ALU는 계산 결괏괎 외에 **플래그** 를 내보낸다.
    - **플래그(flag)**
      - 연산 결과에 대한 추가적인 상태
      - CPU가 프로그램을 실행하는 도중 반드시 기억해야 하는 일종의 참고 정보
      - 플래그들은 **플래그 레지스터** 라는 레지스터에 저장된다.

### 제어장치
- **제어장치**
  - 제어 신호를 내보내고, 명령어를 해석하는 부품
- **제어 신호**
  - 컴퓨터 부품들을 관리하고 작동시키기 위한 일종의 전기 신호
- 제어장치는 CPU의 구성 요소 중 가장 정교하게 설계된 부품이라고 해도 과언이 아니다.
- 제어장치가 받아들이는 정보 순서
  1. **제어장치는 클럭 신호를 받아 들입니다.**
     - **클럭(clock)**
       - 컴퓨터의 모든 부품을 일사불란하게 움직일 수 있게 하는 시간 단위
       - 클럭의 "똑-딱-똑-딱" 주기에 맞춰 한 레지스터에서 다른 레지스터로 데이터가 이동되거나, ALU에서 연산이 수행되거나, CPU가 메모리에 저장된 명령어를 읽어 들인다.
     - "컴퓨터의 모든 부품이 클럭 신호에 맞춰 동작한다" != "컴퓨터의 모든 부품이 한 클럭마다 작동한다"
       - 컴퓨터 부품들은 클럭이라는 박자에 맞춰 작동할 뿐 한 박자마다 작동하는 건 아니다.
       - 하나의 명령어가 여러 클럭에 걸쳐 실행될 수도 있다.
  2. **제어장치는 '해석해야 할 명령어'를 받아들입니다.**
     - CPU가 해석해야 할 명령어는 **명령어 레지스터** 라는 특별한 레지스터에 저장된다.
     - 제어장치는 이 명령어 레지스터로부터 해석할 명령어를 받아들이고 해석한 뒤, 제어 신호를 발생시켜 컴퓨터 부품들에 수행해야 할 내용을 알려 준다.
  3. **제어장치는 플래그 레지스터 속 플래그 값을 받아들입니다.**
     - 플래그는 ALU 연산에 대한 추가적인 상태 정보인데 제어장치는 플래그 값을 받아들이고 이를 참고하여 제어 신호를 발생시킨다.
  4. **제어장치는 시스템 버그, 그중에서 제어 버스로 전달된 제어 신호를 받아들입니다.**
     - 제어 신호는 CPU뿐만 아니라 입출력장치를 비롯한 CPU 외부 장치도 발생시킬 수 있다.
       - 제어장치는 제어 버스를 통해 외부로부터 전달된 제어 신호를 받아들이기도 한다.
- **제어장치가 내보내는 정보**
  - CPU 외부에 전달하는 제어 신호
    - CPU 외부에 제어 신호를 전달하는 말은 제어 버스로 제어 신호를 내보낸다는 말과 같다.
      - 이러한 제어 신호는 크게 메모리에 전달하는 제어 신호와 입출력장치에 전달하는 제어 신호와 입출력장치에 전달하는 제어 신호가 있다.
    - 제어장치가 메모리에 저장된 값을 읽거나 메모리에 새로운 값을 쓰고 싶다면 메모리로 제어 신호를 내보낸다.
      - 그리고 제어장치가 입출력장치의 값을 읽거나 입출력 장치에 새로운 값을 쓰고 싶을 때는 입출력장치로 제어 신호를 보낸다.
  - CPU 내부에 전달하는 제어 신호
    - ALU에 전달하는 제어 신호와 레지스터에 전달하는 제어 신호가 있다.
    - ALU에는 수행할 연산을 지시하기 위해, 레지스터에는 레지스터 간에 데이터를 이동시키거나 레지스터에 저장된 명령어를 해석하기 위해 제어 신호를 내보낸다.
---