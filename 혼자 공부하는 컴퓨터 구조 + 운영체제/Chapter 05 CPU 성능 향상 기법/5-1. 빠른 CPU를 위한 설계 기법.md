# Chapter 05. CPU 성능 향상 기법
## 5-1. 빠른 CPU를 위한 설계 기법

### 클럭
- 클럭 신호가 빠르게 반복되면 CPU를 비롯한 컴퓨터 부품들은 그만큼 빠른 박자에 움직인다.
- 클럭 속도가 높아지면 CPU는 명령어 사이클을 더 빠르게 반복할 것이고, 다른 부품들도 그에 맞춰 더 빠르게 작동할 것이다.
- 클럭 속도는 CPU 속도 단위로 간주되기도 한다.
- **클럭 속도**는 헤르츠(Hz) 단위로 측정한다.
  - 이는 1초에 클럭이 몇 번 반복되는지를 나타낸다.
- **클럭 속도는 일정하지 않다.**
  - '클럭'이라는 단어를 보고 시계를 떠올려 클럭 속도가 매번 일정하게 유지된다고 생가할 수 있지만, 실제로는 그렇지 않다.
  - CPU 사진을 보면 기본 클럭 속도(Base)와 최대 클럭 속도(Max)로 나뉘어 있는데 이처럼 CPU는 계속 일정한 클럭 속도를 유지하는게 아니라 고성능을 요하는 순간에는 순간적으로 클럭 속도를 높이고, 그렇지 않을 때는 유연하게 클럭 속도를 낮춘다.
  - 최대 클럭 속도를 강제로 더 끌어올리는 것을 **오버클럭킹(overclocking)**이라 한다.
- 클럭 속도를 높이는 것은 분명 CPU를 빠르게 만들지만, 클럭 속도만으로 CPU의 성능을 올리는 것은 한계가 있다.

### 코어와 멀티코어
- 클럭 속도를 높이는 방법 외에 CPU의 성능을 높이는 방법
  1. CPU의 코어를 늘리는 방법
  2. 스레드 수를 늘리는 방법
  
#### CPU의 코어를 늘리는 방법
- 'CPU 내에서 명령어를 실행하는 부품'을 **코어(core)**라고 한다.
- 코어를 여러 개 포함하고 있는 CPU를 **멀티코어(multi-core) CPU** 또는 **멀티코어 프로세서**라고 부른다.
- 코어를 n개 늘린다고 해서 연산 처리 속도가 n배 빨라지는건 아니다.
  - CPU의 연산 속도는 꼭 코어 수에 비례하여 증가하지 않는다.
- 중요한 것은 코어마다 처리할 명령어들을 얼마나 적절하게 분배하느냐이고 그에 따라서 연삭 속도는 크게 달라진다.

### 스레드와 멀티스레드
- **쓰레드(thread)**의 사전적 의미는 '실행 흐름의 단위'이다.
- CPU에서 사용되는 **하드웨어적 스레드**가 있고, 프로그램에서 사용되는 **소프트웨어적 스레드**가 있다.

#### 하드웨어적 스레드
- 하드웨어적 스레드는 '하나의 코어가 동시에 처리하는 명령어 단위'를 의미한다.
- CPU에서 사용하는 스레드라는 용어는 보통 CPU 입장에서 정의된 하드웨어적 스레드를 의미한다.
- **멀티스레드(multi thread) 프로세서** 또는 **멀티스레드 CPU**
  - 하나의 코어로 여러 명령어를 동시에 처리하는 CPU
- **하이퍼스레딩(hyper-threading)**
  - 인텔의 멀티스레드 기술

#### 소프트웨어적 스레드
- 소프트웨어적 스레드는 '하나의 프로그램에서 독립적으로 실행되는 단위'를 의미한다.

#### 멀티스레드 프로세서
- 멀티스레드 프로세서는 하나의 코어로 여러 명령어를 동시게 처리하는 기술인 하드웨어적 스레드이다.
- **멀티스레드 프로세서**를 실제로 설계하는 일은 매우 복잡하지만, 가장 큰 핵심은 레지스터이다.
  - 하나의 코어로 여러 명령어를 동시에 처리하도록 만들려면 프로그램 카운터, 스택 포인터, 데이터 버퍼 레지스터, 데이터 주소 레지스터와 같이 하나의 명령어를 처리하기 위해 꼭 필요한 레지스터를 여러개 가지고 있으면 된다.
- 하드웨어적 스레드를 이용해 하나의 코어로도 여러 명령어를 동시에 처리할 수 있다.
  - 그러나 메모리 속 프로그램 입장에서 봤을 때 하드웨어 스레드는 마치 '한번에 하나의 명령어를 처리하는 CPU'나 다름없다.
  - 가령 2코어 4스레드 CPU는 한 번에 네 개의 명령어를 처리할 수 있는데, 프로그램 입장에서 봤을 땐 한 번에 하나의 명령어를 처리하는 CPU가 네 개 있는 것처럼 보인다.
    - 그래서 하드웨어 스레드를 **논리 프로세서(logical processor)**라고 부른다.
- **코어**는 명령어를 실행할 수 있는 '하드웨어 부품'이고, **스레드**는 '명령어를 실행하는 단위'이다.
- **멀티코어 프로세서**는 명령어를 실행할 수 있는 하드웨어 부품이 CPU 안에 두 개 이상 있는 CPU를 의미하고, **멀티스레드 프로세서**는 하나의 코어로 여러개의 명령어를 동시에 실행할 수 있는 CPU를 의미한다.

---