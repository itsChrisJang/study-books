# Chapter 05. CPU 성능 향상 기법
## 5-3. CISC와 RISC
- 명령어 파이프라이닝과 슈퍼스칼라 기법을 실제로 CPU에 적용하려면 명령어가 파이프라이닝에 최적화되어 있어야 한다.
- 쉽게 말해, CPU가 파이프라이닝과 슈퍼스칼라 기법을 효과적으로 사용하려면 CPU가 인출하고 해석하고 실행하는 명령어가 파이프라이닝 하기 쉽게 생겨야 합나다.

### 명령어 집합
- CPU가 이해할 수 있는 명령어들의 모음을 **명령어 집합(instruction set)** 또는 **명령어 집합 구조(ISA: Instruction Set Architecture) (이하 ISA )** 라고 합니다.
  - **ISA**는 CPU의 언어이자 하드웨어가 소프트웨어를 어떻게 이해할지에 대한 약속이다.
- 가령 인텔의 노트북 속 CPU는 x86 혹은 X86-64 ISA를 이해하고, 애플의 아이폰 속 CPU는 ARM ISA를 이해한다.
  - x86(x86-64)과 ARM은 다른 ISA이기 때문에 인텔 CPU를 사용하는 컴퓨터와 아이폰은 서로의 명령어를 이해할 수 없다.
  - ISA가 다르다는 건 CPU가 이해할 수 있는 명령어가 다른다는 뜻이고, 명령어가 달라지면 어셈블리어도 달라진다.
  - 즉, 같은 소스 코드로 만들어진 같은 프로그램이라 할지라도 ISA가 다르면 CPU가 이해할 수 있는 명령어도 어셈블리어도 달라진다는 것이다.
- CPU도 마찬가지로 CPU가 이해하는 명령어들이 달라지면 비단 명령어의 생김새만 달라지는게 아니다.
  - ISA가 다르면 그에 따른 나비 효과로 많은 것이 달라진다.

### CISC
- **CISC(Complex Instruction Set Computer)**
  - '복잡한 명령어 집합을 활용하는 컴퓨터'
  - CISC란 이름 그대로 복잡하고 다양한 명령어들을 활용하는 CPU 설계 방식이다.
  - ISA의 한 종류로 소개한 x86, x86-64는 대표적은 CISA 기반의 ISA이다.
- CISC는 다양하고 강력한 기능의 명령어 집합을 활용하기 때문에 명령어의 형태와 크기가 다양한 **가변 길이 명령어**를 활용한다.
- 장점
  - x86-64의 경우 ARM 명령어 여러 개로 수행할 수 있는 일을 몇개만으로 수행할 수 있어 메모리 공간을 절약할 수 있다.
- 단점
  - 활용하는 명령어가 워낙 복잡하고 다양한 기능을 제공하는 탓에 명령어의 크기와 실행되기까지의 시간이 일정하지 않다.
  - 복잡한 명령어 때문에 명령어 하나를 실행하는 데에 여러 클럭 주기를 필요로 한다.
    - CIS가 활용하는 명령어는 명령어 수행 시간이 길고 가지각색이기 때문에 파이프라인이 효율적으로 명령어를 처리할 수 없다.
    - 즉, 규격화되지 않은 명령어가 파이프라이닝을 어렵게 만든다.
  - CISC가 복잡하고 다양한 명령어를 활용할 수 있다고 하지만, 사실 대다수의 복잡한 명령어는 그 사용 빈도가 낮다.
    - 1974년 IBM 연구소의 존 코크(John Cocke)는 CISC 명령어 집합 중 불과 20% 정도의 명령어가 사용된 전체 명령어의 80% 가량을 차지한다는 것을 증명했다.
- 정리
  - CISC 명령어 집합은 복잡하고 다양한 기능을 제공하기에 적은 수의 명령으로 프로그램을 동작시키고 메모리를 절약할 수 있지만, 명령어의 규격화가 어려워 파이프라이닝이 어렵다.
  - 그리고 대다수의 복잡한 명령어는 그 사용 빈도가 낮다.
  - 이러한 이유로 CISC 기반 CPU는 성장에 한계가 있다.

#### CISC 한게로 알 수 있는 교훈
1. 빠른 처리를 위해 명령어 파이프라인을 십분 활용해야 한다. 원활한 파이프라이닝을 위해 '명령어 길이와 수행 시간이 짧고 규격화'되어 있어야 한다.
2. 어차피 자주 쓰이는 명령어만 줄곧 사용된다. 복잡한 기능을 지원하는 명령어를 추가하기보다는 '자주 쓰이는 기본적인 명령어를 작고 빠르게 만드는 것'이 중요하다.

### RISC
- **RISC(Reduced Instruction Set Computer)**
  - 단순하고 적은 수의 고정 길이 명령어 집합을 활용한다.
  - CISC에 비해 명령어의 종류가 적다.
  - CISC와는 달리 짧고 규격화된 명령어, 되도록 1클럭 내외로 실행되는 명령어를 지향한다.
  - **고정 길이 명령어**를 활용한다.
  - 명령어가 규격화되어 있고, 하나의 명령어가 1클럭 내외로 실행되기 때문에 RISC 명령어 집합은 명령어 파이프라이닝에 최적화되어 있다.
  - 메모리에 직접 접근하는 명령어를 load, store 두 개로 제한할 만큼 메모리 접근을 단순화하고 최소화를 추구한다.
    - 이런 점에서 RISC를 **load-store 구조**라고 부르기도 한다.
  - 메모리 접근을 단순화, 최소화하는 대신 레지스터를 적극적으로 활용한다.
    - 그렇기 때문에 CISC보다 레지스터를 이용하는 연산이 많고, 일반적인 경우보다 범용 레지스터 개수도 더 많다.

| CISC                 | RISC                 |
|----------------------|----------------------|
| 복잡하고 다양한 명령어         | 단순하고 적은 명령어          |
| 가변 길이 명령어            | 고정 길이 명령어            |
| 다양한 주소 지정 방식         | 적은 주소 지정방식           |
| 프로그램을 이루는 명령어의 수가 적음 | 프로그램을 이루는 명령어의 수가 많음 |
| 여러 클럭에 걸쳐 명령어 수행     | 1클럭 내외로 명령어 수행       |
| 파이프라이닝하기 어려움         | 파이프라이닝하기 쉬움          |

---