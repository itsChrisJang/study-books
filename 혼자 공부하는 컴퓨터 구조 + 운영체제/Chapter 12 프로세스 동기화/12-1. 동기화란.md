# Chapter 12 프로세스 동기화
## 12-1. 동기화란
- 동시다발적으로 실행되는 프로세스들은 공동의 목적을 올바르게 수행하기 위해 서로 협력하며 영향을 주고 받기도 한다.
  - 이렇게 협력하여 실행되는 프로세스들은 실행 순서와 자원의 일관성을 보장해야 하기에 반드시 **동기화(synchronization)** 이 되어야 한다.

### 동기화의 의미
- 동시다발적으로 실행되는 많은 프로세스는 서로 데이터를 주고받으며 협력하며 실행될 수 있다.
  - 예를 들어 워드 프로세서에는 사용자로부터 입력을 받는 프로세스와 입력한 내용의 맞춤법을 검사하는 프로세스, 입력한 내용을 화면에 출력해 주는 프로세스 등이 있다.
  - 이 프로세스들은 각기 다른 독립적인 프로세스이지만 공동의 목표를 위해 서로 협력하는 존재이다.
- 이렇게 협력적으로 실행되는 프로세스들은 아무렇게나 마구 동시에 실행해서는 안된다.
  - 올바른 실행을 위해서는 **동기화** 가 필수이다.
- 프로세스 동기화란?
  - '정보 통신 분야에서의 동기화란 작업들 사이에의 수행 시기를 맞추는 것'
  - **프로세스들 사이의 수행 시기를 맞추는 것을 의미한다.**
    - 실행 순서 제어: 프로세스를 올바른 순서대로 실행하기
    - 상보 배제: 동시에 접근해서는 안 되는 자원에 하나의 프로세스만 접근하게 하기
> - 프로세스뿐만 아니라 스레드도 동기화 대상이다.
> - 정확히 말하면 실행의 흐름을 갖는 모든 것은 동기화의 대상이다.
 
#### 첫째, 실행 순서 제어를 위한 동기화에 대해 알아보자.
- Writer라는 프로세스와 Reader라는 프로세스가 동시에 실행 중이라고 가정해보자.
- Writer 프로세스는 Book.txt 파일에 값을 저장하는 프로세스이고, Reader 프로세스는 Book.txt 파일에 저장된 값을 읽어 들이는 프로세스라고 가정하자.
  - 이 두 프로세스는 무작정 아무 순서대로 실행되면 안된다.
    - Reader 프로세스는 Writer 프로세스 실행히 끝나야 비로소 실행할 수 있기 때문이다.
  - 즉, Reader 프로세스는 'Book.txt 안에 값이 존재한다.'는 특정 조건이 만족되어야만 실행을 이어나갈 수 있다.
  - 이렇게 동시에 실행되는 프로세스를 올바른 순서대로 실행하는 것이 첫 번째 프로세스 동기화이다.

#### 둘째, 상호 배제를 위한 동기화에 대해 알아보자.
- **상호 배제(mutual exclusion)** 는 공유가 불가능한 자원의 동시 사용을 피하기 위해 사용하는 알고리즘이다.
- 예시
  - 계좌에 10만 원이 저축되어 있다고 가정하자.
  - 프로세스 A는 현재 저축한 금액에 2만 원을 넣는 프로세스, 프로세스 B는 현재 저축된 금액에 5만 원을 넣는 프로세스이다.
    - 프로세스 A가 실행되는 과정
      1. 계좌의 잔액을 읽어 들인다.
      2. 읽어 들인 잔액에 2만 원을 더한다.
      3. 더한 값을 저장한다.
    - 프로세스 B가 실행되는 과정
      1. 계좌의 잔액을 읽어 들인다.
      2. 읽어 들인 잔액에 5만 원을 더한다.
      3. 더한 값을 저장한다.
  - 프로세스 A와 B가 동시에 실행되었다고 가정해보자.
    - **동기화가 이루어지지 않은 경우**
      - 최종 잔액이 12만 원이 될 수도, 15만 원이 될 수도, 17만 원이 될 수도 있다.
      - 왜 이런 일이 발생할까?
        - A와 B는 '잔액'이라는 데이터를 동시에 사용하는데, A가 끝나기도 전에 B가 잔액을 읽어 버렸기 때문이다.
      - A와 B를 올바르게 실행하기 위해서는 한 프로세스가 잔액에 접근했을 때 다른 프로세스는 기다려야 한다.
    - **동기화가 이루어진 경우**
      - 최종 잔액이 17만 원이 된다.
      - 이렇게 동시에 접근해서는 안 되는 자원에 동시에 접근하지 못하게 하는 것이 **상호 배제를 위한 동기화** 이다.

### 생산자와 소비자 문제
- 생산자와 소비자 문제는 물건을 계속해서 생산하는 프로세스인 생산자와 물건을 계속해서 소비하는 프로세스인 소비자로 이루어져 있다.
- 생상자와 소비자는 '총합'이라는 데이터를 공유하고 있다.
  - 생산자는 버퍼에 물건을 넣은 후, 물건의 총합에 해당하는 변수를 1 증가시키고, 소비자는 버퍼에 물건을 빼낸 후 물건의 총합에 해당하는 변수를 1 감소시킨다.
- 총합을 10으로 가정해보고 


---