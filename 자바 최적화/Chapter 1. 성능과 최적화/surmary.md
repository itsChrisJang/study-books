# Chapter 1. 성능과 최적화
자바 성능을 최적화하는 일은 마치 어둠의 마법처럼 느껴집니다.   
흔히 성능 분석이라 하면 '홀로 고뇌하며 깊은 생각에 빠져 살아가는 고독한 해커'나 할 수 있는 고도의 숙력된 기술처럼 바라봅니다.   

안타깝게도 성능이 소프트웨어 팀의 부차적인 관심사인 상황과 맞물려 있습니다.   
그렇기에 시스템이 결딴나는 지경에 이르러서야 부랴부랴 분석 작업을 해보고 성능 '해결사'에게 구원의 손길을 뻗는 시나리오를 당연하게 생각하는데, 이는 현실과 조금 다릅니다.

실제로 성능 분석은 경험주의와 질퍽한 인간 심리학이 교묘히 어우러진 분야입니다.   
그리고 정작 중요한 건, 관측 지표의 절대 수치, 그리고 엔드 유저(최종 사용자, 실제로 시스템을 사용하는 사람)와 기타 이해관계자들이 그 수치를 어떻게 받아들이는가 하는 점입니다.

## 1.1 자바 성능: 잘못된 방법
자바 초창기에 메서드 디스패치 성능은 정말 최악이었습니다.   
그래서 메서드를 잘게 나누지 말고 하나의 덩치 큰 메서드로 장ㄱ성하는 게 좋다고 권고하는 개발자가 있었는데, 시간이 지나면서 가상 디스패치 성능은 엄청나게 좋아졌고, 특히 최신 자바 가상 머신에서는 자동 인라이닝 덕분에 가상 디스패치조차 대부분의 호출부(콜 사이트)에서 사라지게 되었습니다.   
**'모든 코드를 한 메서드에 욱여넣어라'** 는 말대로 짠 코드는 바야흐로 현대 JIT 컴파일러와는 어울리지 않는 퇴물이 되었습니다.

정량적, 검증 가능한 방식으로 성능을 다루지 않으면 얼마나 안 좋지 영향을 끼칠 수 있는지 깨닫게 되었습니다.

- 우수한 성능 목표 달성을 위해 필요한 단면
  - 전체 소프트웨어 수명주기의 성능 방법론
  - 성능과 연관된 테스트 이론
  - 측정, 통계, 툴링
  - (시스템 + 데이터) 분석 스킬
  - 하부 기술과 메커니즘(장치, 수단)

- 일반적인 원칙
  - JVM을 더 빨리 작동시키는 '마법의 스위치' 같은 건 없습니다.
  - 자바를 더 빨리 실행하게 만드는 '팁, 트릭'은 없습니다.
  - '비밀 알고리즘'도 없습니다.

## 1.2 자바 성능 개요
> 자바는 블루 컬러 언어입니다. 박사 학위 논문 주제가 아니라 일을 하려고 만든 언어죠.

자바는 처음부터 지극히 실용적인 언어였습니다.   
개발 환경이 충분히 빠르다면 개발자 생산성이 높아지는 대가로 어느 정도의 성능 희생은 감수할 만한다는 입장입니다.   
그러나 자바 환경이 고성능 컴퓨팅 애플리케잉션에 적합한 수준에 이른 건 비교적 최근에 핫스팟 같은 정교한 JVM이 성숙했기 때문입니다.

실용성을 추구하는 자바 플랫폼에 성격에는 서비 시스템이 가장 대표적인데, 이 개념은 개발자가 일일이 용량을 세세하게 관리하는 부담을 덜어주고, 대신 저수준으로 제어 가능한 일부 기능을 포기하자는 발상입니다.   
단적으로 메모리 관리가 그렇듯이, JVM이 탈착형 가비지 수집 서브시스템 형태로 메모리를 자동 관리하는 덕분에 프로그래머는 수동으로 메모리를 의식하며 개발할 필요가 없습니다.

JVM 애플리케이션의 성능 측정값은 정규 분포를 따르지 않는 경우가 많아서 기초 통계 기법(예: 표준편차, 분산)만 갖고는 측정 결과를 제대로 처리하기 역부족입니다.   
쉬운 예로 JVM 애플리케이션에서 특이점은 매우 중요한 의미를 내포하고, 즉 측정값을 샘플링하면 특이점을 일으킨 가장 중요한 이벤트가 묻혀버릴 가능성이 큽니다.

## 1.3 성능은 실험과학이다.


